---
apiVersion: v1
kind: ConfigMap
metadata:
  name: corevpn-config
  namespace: corevpn
  labels:
    app.kubernetes.io/name: corevpn
    app.kubernetes.io/component: server
data:
  config.toml: |
    [server]
    listen_addr = "0.0.0.0:1194"
    public_host = "vpn.example.com"
    protocol = "udp"
    max_clients = 100
    data_dir = "/var/lib/corevpn"

    [network]
    subnet = "10.8.0.0/24"
    dns = ["1.1.1.1", "1.0.0.1"]
    redirect_gateway = true
    mtu = 1420

    [security]
    cipher = "chacha20-poly1305"
    tls_min_version = "1.3"
    tls_auth = true
    tls_crypt = false
    cert_lifetime_days = 3650
    client_cert_lifetime_days = 90
    reneg_sec = 3600
    pfs = true

    [logging]
    level = "info"
    format = "json"
    # Ghost mode - set to "none" for zero logging
    connection_mode = "memory"

    [logging.connection_events]
    attempts = false
    connects = true
    disconnects = true
    auth_events = false
    transfer_stats = false

    [logging.anonymization]
    hash_client_ips = false
    truncate_client_ips = false
    hash_usernames = false

    [logging.retention]
    days = 7
    auto_purge = true
